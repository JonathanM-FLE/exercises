<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Les pronoms COI - Application</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Crimson Text', Georgia, serif;
            line-height: 1.6;
            color: #2F2F2F;
            background-color: #F7F3F0;
            padding: 20px;
            max-width: 900px;
            margin: 0 auto;
        }
        
        .cecr-badge {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #E6F3FF;
            color: #2F2F2F;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 14px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            z-index: 1000;
        }
        
        .header {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #E5E5E5;
        }
        
        h1 {
            font-size: 2.2em;
            font-weight: 700;
            margin-bottom: 10px;
            color: #2F2F2F;
        }
        
        .subtitle {
            color: #666;
            font-size: 1.1em;
            margin-bottom: 20px;
        }
        
        .example-box {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 25px;
            border-left: 4px solid #CC785C;
        }
        
        .example-box h3 {
            color: #CC785C;
            margin-bottom: 10px;
            font-size: 1.2em;
        }
        
        .instruction {
            position: relative;
            cursor: help;
            border-bottom: 1px dotted #CC785C;
            display: inline-block;
            margin-bottom: 20px;
        }
        
        .instruction:hover::after {
            content: attr(data-en);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #2F2F2F;
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 14px;
            white-space: nowrap;
            z-index: 1000;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        
        .instruction:hover::before {
            content: '';
            position: absolute;
            bottom: 94%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-top-color: #2F2F2F;
            z-index: 1000;
        }
        
        .info-box {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 25px;
            border-left: 4px solid #2196f3;
        }
        
        .info-box h3 {
            color: #1976d2;
            margin-bottom: 15px;
            font-size: 1.1em;
        }
        
        .info-list {
            display: grid;
            gap: 8px;
        }
        
        .info-item {
            padding: 8px 12px;
            background: rgba(255,255,255,0.7);
            border-radius: 6px;
            border-left: 3px solid #2196f3;
        }
        
        .exercise-container {
            margin-bottom: 30px;
        }
        
        .sentence-item {
            background: white;
            padding: 25px;
            margin-bottom: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            border: 1px solid #E5E5E5;
        }
        
        .sentence-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.12);
        }
        
        .sentence-number {
            background: #CC785C;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            margin-bottom: 15px;
        }
        
        .sentence-original {
            font-size: 18px;
            line-height: 1.8;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 3px solid #CC785C;
        }
        
        .underlined {
            background: linear-gradient(120deg, #fff9c4 0%, #ffeb3b 100%);
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
            text-decoration: underline;
        }
        
        .sentence-transform {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
            font-size: 18px;
            padding: 15px;
            background: #f0f8ff;
            border-radius: 8px;
        }
        
        .arrow {
            color: #CC785C;
            font-weight: 600;
            font-size: 24px;
        }
        
        .pronoun-select {
            padding: 10px 16px;
            border: 2px solid #CC785C;
            border-radius: 8px;
            font-size: 16px;
            background: white;
            cursor: pointer;
            transition: all 0.2s ease;
            min-width: 120px;
        }
        
        .pronoun-select:hover {
            background: #fff5f0;
            transform: scale(1.02);
        }
        
        .pronoun-select:focus {
            outline: none;
            border-color: #a0522d;
            box-shadow: 0 0 0 3px rgba(204, 120, 92, 0.1);
        }
        
        .buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }
        
        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: inherit;
        }
        
        .submit-btn {
            background: #CC785C;
            color: white;
        }
        
        .submit-btn:hover {
            background: #b8694f;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(204, 120, 92, 0.3);
        }
        
        .export-btn {
            background: #E5E5E5;
            color: #2F2F2F;
            border: 1px solid #ccc;
        }
        
        .export-btn:hover {
            background: #d0d0d0;
            transform: translateY(-1px);
        }
        
        .results {
            display: none;
            margin-top: 30px;
            padding: 25px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.08);
            border: 1px solid #E5E5E5;
        }
        
        .result-item {
            padding: 15px;
            margin-bottom: 12px;
            border-radius: 8px;
            background: #f8f9fa;
        }
        
        .correct {
            border-left: 4px solid #4A8B3A;
            background: #f0f8f0;
        }
        
        .incorrect {
            border-left: 4px solid #C53030;
            background: #fef5f5;
        }
        
        .result-text {
            font-size: 16px;
            margin-bottom: 5px;
        }
        
        .correction {
            color: #4A8B3A;
            font-weight: 600;
        }
        
        .score {
            font-size: 20px;
            font-weight: 600;
            margin-top: 20px;
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 8px;
        }
        
        @media (max-width: 768px) {
            .cecr-badge {
                position: static;
                display: inline-block;
                margin-bottom: 20px;
            }
            
            .sentence-transform {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }
            
            .arrow {
                align-self: center;
            }
            
            .buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="cecr-badge">B1</div>
    
    <div class="header">
        <h1>Les pronoms COI - Application</h1>
        <div class="subtitle">Grammaire franÃ§aise</div>
    </div>
    
    <div class="example-box">
        <h3>ðŸ“– Exemple</h3>
        <p><strong>Phrase :</strong> "On va se dÃ©barrasser <span class="underlined">de la peau</span>" â†’ "On va <strong>s'en</strong> dÃ©barrasser"</p>
        <p><em>Le pronom COI remplace un complÃ©ment d'objet indirect.</em></p>
    </div>
    
    <div class="instruction" data-en="Replace the underlined words with the appropriate COI pronoun.">
        <strong>Consigne :</strong> Remplacez les mots soulignÃ©s par le pronom COI appropriÃ©.
    </div>
    
    <div class="info-box">
        <h3>ðŸ“‹ Rappel des pronoms COI</h3>
        <div class="info-list">
            <div class="info-item"><strong>lui</strong> : remplace "Ã  + personne" (singulier)</div>
            <div class="info-item"><strong>leur</strong> : remplace "Ã  + personnes" (pluriel)</div>
            <div class="info-item"><strong>y</strong> : remplace "Ã /dans/sur + chose/lieu"</div>
            <div class="info-item"><strong>en</strong> : remplace "de + chose/quantitÃ©"</div>
        </div>
    </div>
    
    <div class="exercise-container">
        <div class="sentence-item">
            <div class="sentence-number">1</div>
            <div class="sentence-original">
                "Je donne la recette <span class="underlined">Ã  ma sÅ“ur</span>."
            </div>
            <div class="sentence-transform">
                <span class="arrow">â†’</span>
                <span>"Je</span>
                <select class="pronoun-select" id="q1">
                    <option value="">-- Choisir --</option>
                    <option value="lui">lui</option>
                    <option value="leur">leur</option>
                    <option value="y">y</option>
                    <option value="en">en</option>
                </select>
                <span>donne la recette."</span>
            </div>
        </div>
        
        <div class="sentence-item">
            <div class="sentence-number">2</div>
            <div class="sentence-original">
                "Il parle <span class="underlined">de ses lÃ©gumes du jardin</span>."
            </div>
            <div class="sentence-transform">
                <span class="arrow">â†’</span>
                <span>"Il</span>
                <select class="pronoun-select" id="q2">
                    <option value="">-- Choisir --</option>
                    <option value="lui">lui</option>
                    <option value="leur">leur</option>
                    <option value="y">y</option>
                    <option value="en">en</option>
                </select>
                <span>parle."</span>
            </div>
        </div>
        
        <div class="sentence-item">
            <div class="sentence-number">3</div>
            <div class="sentence-original">
                "Nous ajoutons du basilic <span class="underlined">dans la ratatouille</span>."
            </div>
            <div class="sentence-transform">
                <span class="arrow">â†’</span>
                <span>"Nous</span>
                <select class="pronoun-select" id="q3">
                    <option value="">-- Choisir --</option>
                    <option value="lui">lui</option>
                    <option value="leur">leur</option>
                    <option value="y">y</option>
                    <option value="en">en</option>
                </select>
                <span>ajoutons du basilic."</span>
            </div>
        </div>
        
        <div class="sentence-item">
            <div class="sentence-number">4</div>
            <div class="sentence-original">
                "Elle explique la mÃ©thode <span class="underlined">aux Ã©tudiants</span>."
            </div>
            <div class="sentence-transform">
                <span class="arrow">â†’</span>
                <span>"Elle</span>
                <select class="pronoun-select" id="q4">
                    <option value="">-- Choisir --</option>
                    <option value="lui">lui</option>
                    <option value="leur">leur</option>
                    <option value="y">y</option>
                    <option value="en">en</option>
                </select>
                <span>explique la mÃ©thode."</span>
            </div>
        </div>
        
        <div class="sentence-item">
            <div class="sentence-number">5</div>
            <div class="sentence-original">
                "Tu penses <span class="underlined">Ã  acheter de l'huile d'olive</span> ?"
            </div>
            <div class="sentence-transform">
                <span class="arrow">â†’</span>
                <span>"Tu</span>
                <select class="pronoun-select" id="q5">
                    <option value="">-- Choisir --</option>
                    <option value="lui">lui</option>
                    <option value="leur">leur</option>
                    <option value="y">y</option>
                    <option value="en">en</option>
                </select>
                <span>penses ?"</span>
            </div>
        </div>
    </div>
    
    <div class="buttons">
        <button type="button" class="submit-btn" onclick="exercise.checkAnswers()">Valider mes rÃ©ponses</button>
        <button type="button" class="export-btn" onclick="exercise.exportMarkdown()">ðŸ“„ Exporter rÃ©sultats</button>
    </div>
    
    <div id="results" class="results">
        <h3>ðŸ“Š RÃ©sultats</h3>
        <div id="resultDetails"></div>
        <div class="score" id="score"></div>
    </div>
    
    <script>
        class ExerciseManager {
            constructor() {
                this.cecrLevel = 'B1';
                this.startTime = new Date();
                this.answers = [];
                this.correctAnswers = {
                    q1: 'lui',
                    q2: 'en',
                    q3: 'y',
                    q4: 'leur',
                    q5: 'y'
                };
                this.explanations = {
                    q1: 'lui - remplace "Ã  ma sÅ“ur" (COI personne singulier)',
                    q2: 'en - remplace "de ses lÃ©gumes" (COI avec "de")',
                    q3: 'y - remplace "dans la ratatouille" (COI lieu)',
                    q4: 'leur - remplace "aux Ã©tudiants" (COI personnes pluriel)',
                    q5: 'y - remplace "Ã  acheter..." (COI avec "Ã " + chose)'
                };
            }
            
            checkAnswers() {
                let score = 0;
                let resultHTML = '';
                this.answers = [];
                
                Object.keys(this.correctAnswers).forEach((question, index) => {
                    const select = document.getElementById(question);
                    const isCorrect = select.value === this.correctAnswers[question];
                    
                    this.answers.push({
                        question: index + 1,
                        userAnswer: select.value,
                        correct: isCorrect,
                        expectedAnswer: this.correctAnswers[question],
                        explanation: this.explanations[question]
                    });
                    
                    if (isCorrect) {
                        score++;
                        select.style.borderColor = '#4A8B3A';
                        resultHTML += `
                            <div class="result-item correct">
                                <div class="result-text">Question ${index + 1} : âœ“ Correct</div>
                                <div class="correction">${this.explanations[question]}</div>
                            </div>
                        `;
                    } else {
                        select.style.borderColor = '#C53030';
                        resultHTML += `
                            <div class="result-item incorrect">
                                <div class="result-text">Question ${index + 1} : âœ— Incorrect</div>
                                <div class="correction">RÃ©ponse attendue : ${this.explanations[question]}</div>
                            </div>
                        `;
                    }
                });
                
                document.getElementById('resultDetails').innerHTML = resultHTML;
                document.getElementById('score').innerHTML = `Score : ${score}/5 (${Math.round(score/5*100)}%)`;
                document.getElementById('results').style.display = 'block';
            }
            
            exportMarkdown() {
                const endTime = new Date();
                const duration = Math.round((endTime - this.startTime) / 1000);
                const minutes = Math.floor(duration / 60);
                const seconds = duration % 60;
                
                const score = this.answers.filter(a => a.correct).length;
                const percentage = Math.round((score / this.answers.length) * 100);
                
                let markdown = `# ðŸ“š RÃ©sultats FLE - ${this.cecrLevel} - QCM

**Niveau CECR :** ${this.cecrLevel}  
**Date :** ${new Date().toLocaleDateString('fr-FR')} Ã  ${new Date().toLocaleTimeString('fr-FR')}  
**Exercice :** Les pronoms COI - Application  

---

## ðŸ“Š Performance
- **Score final :** ${score > this.answers.length/2 ? 'âœ…' : 'âŒ'} ${score}/${this.answers.length} (${percentage}%)
- **Temps passÃ© :** â±ï¸ ${minutes}min${seconds}s

---

## ðŸ“ DÃ©tail des rÃ©ponses
`;

                this.answers.forEach(answer => {
                    const status = answer.correct ? 'âœ…' : 'âŒ';
                    markdown += `
**Question ${answer.question} :** ${status}  
- RÃ©ponse donnÃ©e : "${answer.userAnswer || 'Aucune rÃ©ponse'}"  
- RÃ©ponse attendue : ${answer.expectedAnswer}  
- Explication : ${answer.explanation}  
`;
                });

                markdown += `
---

*Exercice FLE gÃ©nÃ©rÃ© automatiquement*`;

                // TÃ©lÃ©chargement du fichier
                const blob = new Blob([markdown], { type: 'text/markdown' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `resultats-pronoms-coi-${new Date().toISOString().split('T')[0]}.md`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }
        }
        
        // Initialisation
        const exercise = new ExerciseManager();
        
        // Animation des sÃ©lecteurs
        document.querySelectorAll('.pronoun-select').forEach(select => {
            select.addEventListener('change', function() {
                this.style.transform = 'scale(1.05)';
                setTimeout(() => {
                    this.style.transform = 'scale(1)';
                }, 200);
            });
        });
    </script>
</body>
</html>